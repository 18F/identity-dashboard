<h1 class="usa-display"><%= t('service_provider_form.wizard_steps.authentication') %></h1>
<p class="usa-intro"><%= t('simple_form.lead.authentication_html') %></p>
<div class="wizard-main">
<%= wizard_form do |form| %>
  <%= render partial: 'fieldset', locals: {
      form: form,
      fieldname: 'identity_protocol',
      description: true,
      html_desc: false,
      db_fieldname: :identity_protocol,
      input_type: 'radio',
      required: true,
      inputs: ServiceProvider.identity_protocols.map { |k,v|
        [titleize(k), k] }.to_h,
    } %>

  <%= form.input :ial,
                 as: :select,
                 collection: [[t('service_provider_form.ial_option_1'), 1],
                              [t('service_provider_form.ial_option_2'), 2]],
                 selected: form.object.ial,
                 input_html: { class: 'usa-input usa-select'},
                 label: t('simple_form.labels.service_provider.ial'),
                 hint: t('service_provider_form.identity_assurance_level_html') %>

  <%= form.input :default_aal,
                 as: :select,
                 collection: [
                   [t('service_provider_form.aal_option_default'), nil],
                   [t('service_provider_form.aal_option_2'), 2],
                   [t('service_provider_form.aal_option_3'), 3]],
                 selected: form.object.default_aal,
                 input_html: { class: 'usa-input usa-select'},
                 label: 'Default Authentication Assurance Level (AAL)' %>

  <%= render partial: 'fieldset', locals: {
      form: form,
      fieldname: 'attribute_bundle',
      description: true,
      html_desc: false,
      db_fieldname: :attribute_bundle,
      input_type: 'checkbox',
      required: false,
      inputs: ServiceProvider.possible_attributes
    } %>
<% end %>
</div>
